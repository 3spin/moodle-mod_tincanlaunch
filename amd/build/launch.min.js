/**
 * Handles display of the launch attempt table (registrations).
 *
 * @package
 * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
 * @author    David Pesce  (david.pesce [at] exputo [dt] com)
 * @module    mod_tincanlaunch/launch
 */
define("mod_tincanlaunch/launch",["jquery","core/str"],(function($,Str){var id="",n="",SELECTORS_ATTEMPT_TABLE="#tincanlaunch_attempttable",SELECTORS_COMPLETION_CHECK="#tincanlaunch_completioncheck",SELECTORS_EXIT="#tincanlaunch_exit",SELECTORS_LAUNCH_FORM="#launchform",SELECTORS_NEW_ATTEMPT="#tincanlaunch_newattempt",SELECTORS_NEW_ATTEMPT_LINK="[id^=tincanlaunch_newattemptlink-]",SELECTORS_REATTEMPT="[id^=tincanrelaunch_attempt-]",SELECTORS_REGISTRATION="#launchform_registration",SELECTORS_STATUSDIV="#tincanlaunch_status",SELECTORS_STATUSPARA="#tincanlaunch_status_para";return{init:function(){var self=this,urlparams=new URLSearchParams(window.location.search);id=urlparams.get("id"),n=urlparams.get("n"),$(SELECTORS_REATTEMPT).each((function(){var registrationid=$(this).attr("id").substring(23);$(this).keyup((function(e){self.keyTest(e.keyCode,registrationid)})),$(this).click((function(){self.launchExperience(registrationid)})),$(this).attr("tabindex","0"),$(this).attr("class","btn btn-primary"),$(this).attr("style","text-align: right")}));var newregistrationid=$(SELECTORS_NEW_ATTEMPT_LINK).attr("id").substring(28);$(SELECTORS_NEW_ATTEMPT_LINK).attr("tabindex","0"),$(SELECTORS_NEW_ATTEMPT_LINK).attr("style","text-align: right"),$(SELECTORS_NEW_ATTEMPT_LINK).click((function(){self.launchExperience(newregistrationid)})),$(SELECTORS_NEW_ATTEMPT_LINK).keyup((function(e){self.keyTest(e.keyCode,newregistrationid)}));var statuspara=$("<p></p>").attr("id","tincanlaunch_status_para"),completionspan=$("<span>").attr("id","tincanlaunch_completioncheck");$(SELECTORS_STATUSDIV).append(statuspara,completionspan),setInterval((function(){$(SELECTORS_COMPLETION_CHECK).load("completion_check.php?id="+id+"&n="+n)}),3e4)},keyTest:function(keycode,registrationid){13!==keycode&&32!==keycode||this.launchExperience(registrationid)},launchExperience:function(registrationid){$(SELECTORS_REGISTRATION).val(registrationid),$(SELECTORS_LAUNCH_FORM).submit(),$(SELECTORS_NEW_ATTEMPT).remove(),$(SELECTORS_ATTEMPT_TABLE).remove(),Str.get_strings([{key:"tincanlaunch_progress",component:"tincanlaunch"},{key:"returntocourse",component:"tincanlaunch"}]).done((function(s){$(SELECTORS_STATUSPARA).text(s[0]);var exitpara=$("<p></p>").attr("id",SELECTORS_EXIT);exitpara.html("<a href='complete.php?id="+id+"&n="+n+"'>"+s[1]+"</a>"),$(SELECTORS_STATUSPARA).after(exitpara)}))}}}));

//# sourceMappingURL=launch.min.js.map